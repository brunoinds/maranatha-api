import{R as C}from"./RequestAPI-525527de.js";import{d as x,r as _,c as d,w as t,u as a,o as c,a as s,b as D,e as k,Y as B,h as U,g as I,i as N,j as P,I as O,l as L,G as V,H as K,J as S,f as T,E,F,k as H,y as R,z as u,m as j,s as q,v as i,K as m,an as z}from"./index-645108c8.js";const Y=x({__name:"Users",setup(A){const p=_(!0),h=_([]),w=async()=>{C.get("/users").then(e=>{h.value=e}).catch(e=>{console.log(e)}).finally(()=>{p.value=!1})},f=async(e=null)=>{const n=await u.create({header:"Nuevo usuário",inputs:[{type:"text",placeholder:"Nombres y apellidos",value:e?e.name:null},{type:"email",placeholder:"Correo electrónico",value:e?e.email:null},{type:"text",placeholder:"Nombre de usuario",value:e?e.username:null},{type:"password",placeholder:"Contraseña",value:e?e.password:null}],buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"Crear Usuário",role:"confirm"}]});await n.present();const{role:o,data:r}=await n.onDidDismiss();if(o=="confirm"){const v={name:r.values[0],username:r.values[2],email:r.values[1],password:r.values[3]};C.post("/users",v).then(y=>{u.create({header:"¡Éxito!",message:"Usuário creado correctamente",buttons:["OK"]}).then(async l=>{await l.present(),await l.onDidDismiss(),w()})}).catch(y=>{u.create({header:"Oops...",message:y.response.message,buttons:["OK"]}).then(async l=>{await l.present(),await l.onDidDismiss(),f(v)})})}},b=async e=>{const n=await z.create({header:"Opciones para "+e.name,buttons:[{text:"Borrar usuario",role:"destructive",data:{action:"deleteUser"}},{text:"Cambiar clave",data:{action:"changePassword"}},{text:"Cancelar",role:"cancel",data:{action:"cancel"}}]});await n.present();const{role:o,data:r}=await n.onDidDismiss();console.log(o,r),r.action=="changePassword"&&g()},g=async e=>{const n=await u.create({header:"Cambiar contraseña",inputs:[{type:"password",placeholder:"Nueva contraseña"}],buttons:[{text:"Cancelar",role:"cancel",handler:()=>{}},{text:"Cambiar contraseña",role:"confirm"}]});await n.present(),await n.onDidDismiss()};return w(),(e,n)=>(c(),d(a(R),null,{default:t(()=>[s(a(O),null,{default:t(()=>[s(a(D),null,{default:t(()=>[s(a(k),{slot:"start"},{default:t(()=>[s(a(B),{"default-href":"/"})]),_:1}),s(a(U),null,{default:t(()=>[I("Usuários")]),_:1}),p.value?(c(),d(a(N),{key:0,type:"indeterminate"})):P("",!0)]),_:1})]),_:1}),s(a(H),null,{default:t(()=>[s(a(L),null,{default:t(()=>[(c(!0),V(S,null,K(h.value,o=>(c(),d(a(j),{key:o.id,button:"",onClick:r=>b(o),detail:!0},{default:t(()=>[s(a(q),null,{default:t(()=>[i("h2",null,[i("b",null,m(o.name),1)]),i("h3",null,m(o.email),1),i("p",null,"Usuário: @"+m(o.username),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}),s(a(T),{onClick:f},{default:t(()=>[s(a(E),{icon:a(F)},null,8,["icon"]),I(" Nuevo usuario ")]),_:1})]),_:1})]),_:1}))}});export{Y as default};
